<a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L200" class="view-source"><i class="icon-eye-open"> </i>View source</a><h1><code ng:non-bindable="">NarrativeAuth</code>
<div><span class="hint">service in module <code ng:non-bindable="">api.narrative</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="api-narrative-narrativeauth-page"><p>Use <code>NarrativeAuthProvider</code> for changing the default behaviour of
<code>NarrativeAuth</code>.</p>
<h4 id="description_note">NOTE</h4>
<p>A NarrativeAuth with a specific name can only be created <em>ONCE</em>. It
does not matter if it is firstly instantiated with just a name, and
then referenced with a config, but this config will have not effect:</p>
<pre><code class="lang-javascript">// Creates the instance
var unconfigured = NarrativeAuth(&#39;AuthorityChicken&#39;);

// Just a reference to the created instance
var configured = NarrativeAuth({
  // A bunch of cool configurations
  name : &#39;AuthorityChicken&#39;
});

// None of the cool configurations has any effect, only defauts active!
unconfigured === configured; // True
</code></pre>
</div></div>
<h2 id="dependencies">Dependencies</h2>
<ul class="dependencies"><li><code ng:non-bindable=""><a href="#/reference/ng.$http">$http</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/reference/ng.$q">$q</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/reference/ng.$window">$window</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/reference/ng.$rootScope">$rootScope</a></code>
</li>
<li><code ng:non-bindable=""><a href="#/reference/ng.$injector">$injector</a></code>
</li>
</ul>
<h2 id="usage">Usage</h2>
<div class="usage"><pre class="prettyprint linenums">NarrativeAuth([config]);</pre>
<h4 id="usage_parameters">Parameters</h4><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>config <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="api-narrative-narrativeauth-page"><p>The name or configuration of the instance
to fetch or create.</p>
</div></td></tr></tbody></table><h4 id="usage_returns">Returns</h4><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">Object</a></td><td><div class="api-narrative-narrativeauth-page"><p>The Auth object representing the created instance.</p>
</div></td></tr></table></div>
<div class="member method"><h2 id="methods">Methods</h2>
<ul class="methods"><li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L302" class="view-source icon-eye-open"> </a><h3 id="methods_config">config()</h3>
<div class="config"><div class="narrativeauth-config-page"><p>A getter for the config object used to create this instance.</p>
</div><h5 id="methods_config_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-config-page"><p>The config object used to create this
Authorization instance.</p>
</div></td></tr></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L332" class="view-source icon-eye-open"> </a><h3 id="methods_getoauthtoken">getOauthToken(code, parameters)</h3>
<div class="getoauthtoken"><div class="narrativeauth-getoauthtoken-page"><p>Makes a POST request to the Oauth server requesting a token. This
is implemented supporting the Authorization Code Grant Flow, requiring
both a client ID and a Client secret to be set.</p>
<p>This also prevents <code>requireAuth()</code> from instantly rejecting the
promise when not logged in, but instead makes it wait until the
outcome of this method is decided.</p>
</div><h5 id="methods_getoauthtoken_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>code</td><td><a href="" class="label type-hint type-hint-string">string</a></td><td><div class="narrativeauth-getoauthtoken-page"><p>The code fetched from the URL in a redirect
call from the Oauth server.</p>
</div></td></tr><tr><td>parameters <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-getoauthtoken-page"><p>Additional parameters for the callback
after authorization to recieve.</p>
</div></td></tr></tbody></table><h5 id="methods_getoauthtoken_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="narrativeauth-getoauthtoken-page"><p>A promise that resolves when a response is recieved,
in which case it will contain the authorized
instance. If the code is not correct or the $http
fails in some way, the promise will be rejected
with an appropriate reason.</p>
</div></td></tr></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L381" class="view-source icon-eye-open"> </a><h3 id="methods_oauthauthorizationcode">oauthAuthorizationCode(parameters)</h3>
<div class="oauthauthorizationcode"><div class="narrativeauth-oauthauthorizationcode-page"><p>Redirects the window location to the set Oauth server landing page,
and initializes a Authorization Code Grant flow.</p>
</div><h5 id="methods_oauthauthorizationcode_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>parameters <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-oauthauthorizationcode-page"><p>Additional parameters for the callback
after authorization to recieve.</p>
</div></td></tr></tbody></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L413" class="view-source icon-eye-open"> </a><h3 id="methods_oauthclientcredentials">oauthClientCredentials(parameters)</h3>
<div class="oauthclientcredentials"><div class="narrativeauth-oauthclientcredentials-page"><p><em>NOT IMPLEMENTED YET.</em></p>
</div><h5 id="methods_oauthclientcredentials_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>parameters <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-oauthclientcredentials-page"><p>Additional parameters for the callback
after authorization to recieve.</p>
</div></td></tr></tbody></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L397" class="view-source icon-eye-open"> </a><h3 id="methods_oauthimplicit">oauthImplicit(parameters)</h3>
<div class="oauthimplicit"><div class="narrativeauth-oauthimplicit-page"><p><em>NOT IMPLEMENTED YET.</em></p>
</div><h5 id="methods_oauthimplicit_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>parameters <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-oauthimplicit-page"><p>Additional parameters for the callback
after authorization to recieve.</p>
</div></td></tr></tbody></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L429" class="view-source icon-eye-open"> </a><h3 id="methods_oauthrefreshtoken">oauthRefreshToken(parameters)</h3>
<div class="oauthrefreshtoken"><div class="narrativeauth-oauthrefreshtoken-page"><p><em>NOT IMPLEMENTED YET.</em></p>
</div><h5 id="methods_oauthrefreshtoken_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>parameters <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-oauthrefreshtoken-page"><p>Additional parameters for the callback
after authorization to recieve.</p>
</div></td></tr></tbody></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L516" class="view-source icon-eye-open"> </a><h3 id="methods_onauth">onAuth(callback, context)</h3>
<div class="onauth"><div class="narrativeauth-onauth-page"><p>Sets a callback for when the user is authenticated by the server.
**Note that this only applies for when the user is authenticated by
the server, not for when the token is set by the <code>token()</code> method.</p>
</div><h5 id="methods_onauth_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>callback</td><td><a href="" class="label type-hint type-hint-function">function</a></td><td><div class="narrativeauth-onauth-page"><p>A callback function with the signature
<code>function(NarrativeAuth, object)</code> where
NarrativeAuth is the newly authenticated
object, and object is the optional state
parameters passed from the oauth initiator.</p>
</div></td></tr><tr><td>context <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">*</a></td><td><div class="narrativeauth-onauth-page"><p>An optional context for the callback.</p>
</div></td></tr></tbody></table><h5 id="methods_onauth_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-narrativeauth">NarrativeAuth</a></td><td><div class="narrativeauth-onauth-page"><p><code>this</code>is returned for chaining purposes.</p>
</div></td></tr></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L486" class="view-source icon-eye-open"> </a><h3 id="methods_requireauth">requireAuth()</h3>
<div class="requireauth"><div class="narrativeauth-requireauth-page"><p>This creates a promise which is returned and resolved if the Auth
instance has a token, and rejected if not. If a token fetch is in
progress, this will wait for that fetch to resolve before moving on
to determine the outcome of the returned promise.</p>
<p>If no reject is desired when waiting for the authentication to
complete, please see <code>waitForAuth()</code>.</p>
</div><h5 id="methods_requireauth_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="narrativeauth-requireauth-page"><p>A promise that resolves with the auth object if
a successful login has been made, and rejects with
the reason <code>&#39;AUTH_REQUIRED&#39;</code> if not.</p>
</div></td></tr></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L568" class="view-source icon-eye-open"> </a><h3 id="methods_token">token(tokenObject)</h3>
<div class="token"><div class="narrativeauth-token-page"><p><code>token()</code> provides a getter when no arguments are supplied or as a
setter if a token is provided. It will still return the token if used
as a setter.</p>
<p>On a successful set of the token, an event will be emitted on the
$rootScope, which will be called <code>&#39;[auth_name].auth&#39;</code>. This will
contain the Auth instance as an argument.</p>
</div><h5 id="methods_token_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>tokenObject <div><em>(optional)</em></div></td><td><a href="" class="label type-hint type-hint-object">object</a></td><td><div class="narrativeauth-token-page"><p>A token object contining at least the the
attributes <code>token_type</code> and
<code>access_token</code>. If omitted, the method
will return any existing token.</p>
</div></td></tr></tbody></table><h5 id="methods_token_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-object">object|null</a></td><td><div class="narrativeauth-token-page"><p>The token object assoiciated with this Auth
instance, or <code>null</code> if not authenticeted yet.</p>
</div></td></tr></table></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L597" class="view-source icon-eye-open"> </a><h3 id="methods_unauth">unauth()</h3>
<div class="unauth"><div class="narrativeauth-unauth-page"><p>Will remove the token from this instance, and from the cache as well,
along with all data stored in the same namespace in the cache.</p>
<p>On a removel of the token, an event will be emitted on the
$rootScope, which will be called <code>&#39;[auth_name].unauth&#39;</code>. This will
contain the Auth instance as an argument.</p>
</div></div>
</li>
<li><a href="https://github.com/amlinger/angular-narrative-api/blob/master/src/auth.provider.js#L450" class="view-source icon-eye-open"> </a><h3 id="methods_waitforauth">waitForAuth()</h3>
<div class="waitforauth"><div class="narrativeauth-waitforauth-page"><p>This creates a promise which is returned and never rejected, only
resolved after a successful login.</p>
<p>If a reject is desired from the promise when it is not authenticated,
please see <code>requireAuth()</code>.</p>
</div><h5 id="methods_waitforauth_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="narrativeauth-waitforauth-page"><p>A promise that resolves when a successful login has
been made. This promise will be resolved with the
successful auth object.</p>
</div></td></tr></table></div>
</li>
</ul>
</div>
</div>
